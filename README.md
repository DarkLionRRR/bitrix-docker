# 1С-Битрикс: Управление сайтом + Docker

Конфигурация Docker для локальной разработки приложений на базе 1С-Битрикс

На текущий момент работает только последнии версии ядра на базе `PHP-8.3`

### Образы
1. База данных - mariadb:latest
2. Бэкенд - Dockerfile на базе php8.3-fpm с установленной nginx

Это только первые наброски. Я недавно начал знакомиться с инструментами Docker. Собирая из готовых образов обнаружил, что чтобы nginx корректно отдавал стили, скрипты, изображения и другие статичные файлы, нужно volume формировать и в образе nginx, и в образе php. Разделить, к сожалению, невозможно, т.к. файлов очень много и очень много директорий хранения, плюс это все вперемешку. Я решил собрать свой Dokerfile, чтобы один проект - один образ.

### Использование
1. Клонировать репозиторий
```
git clone https://github.com/DarkLionRRR/bitrix-docker.git
```
2. В корне создать директорию `sites`
3. Внутри `sites` создать директорию для сайта. Например, `bitrix.site`
4. Внутри директории сайта скачать и распаковать архив нужной редакции с официального сайта Битрикс.
5. В конфигурации `/.docker/nginx/sites-enabled/docker.darklion.conf` изменить в строке 7 `docker.darklion` на название директории вашего сайта (неудобства настройки и env переменные будут добавлены позднее).
6. Запустить docker compose:
```
docker-compose up -d
```
7. В браузере открыть `http://localhost:1488`

### Стадия
В целом, сборка работает, приложение редакции "Бизнес" запускается. Нужно исправить некоторые недочеты, которые CMS в инструментах тестирования показывает.

### Планы
1. Устранить недочеты конфигурации Docker
2. Решить неудобства конфигурирования и добавить env-переменные
2. Добавить поддержку "Композитный сайт"
3. Добавить поддержку многосайтовости
4. Внедрить memcache, redis, nodejs (для push & pool)
5. Сконфигурировать сборки для более старых версий php (до 7.4, т.к. есть много legacy-проектов на старом ядре)
6. Попробовать пересобрать на образе php8.3-fpm-alpine (на базе debian работает неплохо, но alpine легче и пошустрее. Детально еще не тестировал)